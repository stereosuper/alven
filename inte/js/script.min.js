$(function(){function e(){r=d>f?-1:1,f=d}function n(e){var n=0,t=e.length,i=[],o="",s=0,a=0,l="",d=0;for(n;t>n;n++){for(o=e.eq(n).html(),i=o.split(""),s=0,a=i.length,l="",d=0,s;a>s;s++)d+=.013,d=Math.round(1e3*d)/1e3," "===i[s]&&(i[s]="&nbsp;"),l+='<span style="transition-delay:'+d+'s">'+i[s]+"</span>";e.eq(n).html('<span class="bg"></span><span class="before">'+l+'</span><span class="after">'+l+"</span>")}}function t(){function e(){var e=0,t=n.length,i=n.eq(0).innerWidth();for(e;t>e;e++){var o=n.eq(e).offset().left+i;o>u||i>o?n.eq(e).addClass("off"):n.eq(e).removeClass("off")}}var n=q.find(".spotlight-post"),t=q.find(".container").innerWidth();e(),t>u?H?H[0].enable():H=Draggable.create("#spotlightDrag",{type:"x",bounds:q,cursor:"grab",onDrag:e,onDragStart:function(){q.find(".container").addClass("grabbing")},onDragEnd:function(){q.find(".container").removeClass("grabbing")}}):H&&H[0].disable()}function i(e){e.split({type:"words"}),TweenMax.staggerFrom(e.words,.3,{ease:Expo.easeInOut,opacity:0,y:100},.03)}function o(){var e=20,n=v.innerHeight(),t=c.offset().top,i=c.innerHeight();i+2*e>n&&w>n+h+e?d>=M-h-e?(d+n+h+e>t+i-e?v.css({top:i-e-n+20,width:b}).removeClass("fixed").addClass("fixedBot"):v.css({top:h+e,width:b}).removeClass("fixedBot").addClass("fixed"),d>(i+t)/2?(v.find("li").eq(0).find(".img").addClass("off"),v.find("li").eq(1).find(".img").addClass("on")):(v.find("li").eq(0).find(".img").removeClass("off"),v.find("li").eq(1).find(".img").removeClass("on"))):v.css({top:0,width:b}).removeClass("fixed fixedBot"):v.css({top:0}).removeClass("fixed fixedBot")}function s(e){var n=e.length,t=0;for(TweenMax.set(e,{opacity:0}),t;n>t;t++)new ScrollMagic.Scene({triggerElement:e[t]}).triggerHook(.7).setTween(TweenMax.to(e.eq(t),.25,{opacity:1})).addTo(k)}function a(){TweenMax.set(D.find(".menu-title"),{y:"-100%",opacity:0}),TweenMax.set(D.find(".menu-subtitle"),{y:"-100%",opacity:0}),TweenMax.set(D.find("li"),{y:"-120%",opacity:0})}var l=$("html"),d=0,r=0,f=0,g=$("#header"),h=g.innerHeight(),c=$("#mainContent"),p=$("#readIndicator"),m=$(document).height(),w=$(window).height(),u=$(window).width(),x=$(".btn"),y=$(".btn-invert"),C=$("#main"),T=$("#contentHeader"),v=$("#postSidebar"),M=0,b=0,q=$("#spotlightPost"),H=!1,S=$("#related"),D=$("#menu-responsive"),k=new ScrollMagic.Controller;if(isMobile.any?l.addClass("is-mobile"):l.addClass("is-desktop"),x.length&&(n(x),s(x)),y.length&&(n(y),s(y)),q.length&&(t(),TweenMax.set(q.find(".spotlight-post"),{y:"-100%"}),new ScrollMagic.Scene({triggerElement:"#spotlightPost"}).triggerHook(.9).setTween(TweenMax.staggerTo(q.find(".spotlight-post"),.25,{y:"0%"},.1)).addTo(k)),S.length){var B=S.find(".read-also-post"),E=B.length,W=0;for(TweenMax.set(B,{opacity:0}),W;E>W;W++)new ScrollMagic.Scene({triggerElement:"#related"}).triggerHook(.7).setTween(TweenMax.staggerTo(B,.25,{opacity:1},.1)).addTo(k)}if(c.length&&c.find("img").length){var I=c.find("img").not(".no-scroll");s(I)}D.length&&a(),$("#burger").on("click",function(e){e.preventDefault(),l.toggleClass("menu-open"),l.hasClass("menu-open")?setTimeout(function(){var e=0,n=D.find(".menu-small").length;for(e;n>e;e++)TweenMax.to(D.find(".menu-title").eq(e),.25,{y:"0%",opacity:1}),TweenMax.to(D.find(".menu-subtitle").eq(e),.25,{y:"0%",opacity:1}).delay(.05),TweenMax.staggerTo(D.find(".menu-small").eq(e).find("li"),.25,{y:"0%",opacity:1},.08)},380):a()}),$("input").on("change",function(){$(this).val()?$(this).addClass("filled"):$(this).removeClass("filled")}),$(document).scroll(function(){if(d=$(document).scrollTop(),e(),c.length&&!l.hasClass("menu-open")&&(d>c.offset().top-h-40?g.addClass("fixed"):g.removeClass("fixed"),g.hasClass("fixed")&&(0>r?g.addClass("on@"):g.removeClass("on"))),p.length){var n=(d-c.offset().top)/(c.innerHeight()-w);d>c.offset().top&&TweenMax.set(p,{scaleX:n})}T.length&&!isMobile.any&&(TweenMax.set(T.find("h1"),{y:"-"+d/4+"%"}),T.find(".img").length&&TweenMax.set(T.find(".img"),{y:"-"+d/40+"%"})),v.length&&c.length&&!isMobile.any&&o()}),$(window).resize(function(){m=$(document).height(),w=$(window).height(),u=$(window).width(),u>979&&l.removeClass("menu-open"),C.length&&T.length&&C.css("marginTop",T.innerHeight()),v.length&&(v.css({top:0,width:"20%"}).removeClass("fixed fixedBot"),M=v.offset().top,b=v.innerWidth()-1),q.length&&t()}),$(window).load(function(){if(m=$(document).height(),T.length&&(C.length&&C.css("marginTop",T.innerHeight()),T.find("h1").length)){var e=new SplitText(T.find("h1"),{type:"words"});T.find("h1").css("opacity",1),i(e)}v.length&&(M=v.offset().top,b=v.innerWidth()-1)})});